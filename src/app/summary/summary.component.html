<div [align]="'center'" class="main-grid-col-12">
    <!-- Logo -->
  <div class="p-text-center">
    <img src="assets/SarAIh_Maas_V2.png" alt="Sarah Maas" width="300">
    <h5>SarAIh Maas can give you detailed analysis on the Crescent City series of Sarah Maas Books</h5>
  </div>

  <!-- Chapter selection -->
  <div class="chapter-col">
    <p-select 
        [options]="books" 
        [(ngModel)]="selectedBook"
        placeholder="Select a Book"
        (onChange)="onBookChange()">
    </p-select>
    
  <br>
  <!--Part List-->
    <div>
    @if (selectedBook) {
      <p-select 
          [options]="parts" 
          [(ngModel)]="selectedPart"
          (onChange)="fetchChapterFromPart()"
          placeholder="Select a Part">
      </p-select>
    }
    </div>
    <br>
    <!--Chapter List-->    
      @if (selectedBook && selectedPart && !selectedChapter) {
        <div class="chapter-row">
          <p-select 
              [options]="chapters" 
              [(ngModel)]="selectedChapter"
              placeholder="Select a Chapter">
          </p-select>
        </div>
      }

      @if (selectedChapter) {
        <div class="chapter-row-with-button">
          <p-select 
          [options]="chapters" 
          [(ngModel)]="selectedChapter"
          placeholder="Select a Chapter">
          </p-select>
          
          <p-button [raised]="true"
            label="Show Entire Chapter"
            icon="pi pi-book" 
            (onClick)="fetchChapterContent(selectedChapter)">
          </p-button>
        </div>
      }    
  </div>

  <p-dialog
    [header]="'Chapter Summary - ' + selectedChapter"
    [modal]="true"
    [style]="{width: '40vw', height: '35vw'}"
    [closable]="true"
    [(visible)]="displayDialog"
    (onHide)="onHideDialog()">
    @if (!dataFetch) {
      <div class="block">
        <label class="font-color: solid rgb(100,0,0);">Fetching Summary...</label>
        <br><br>
        <p-progress-spinner ariaLabel="loading" [style]="{ width: '40px', height: '30px' }"/>
      </div>      
    }
    @if (chapterContent != '') {
    <p align="left">
      {{chapterContent}}
    </p>
      <p-scrolltop target="parent" styleClass="custom-scrolltop" icon="pi pi-arrow-up" />
    }
    @else if (chapterContent === '' && dataFetch) {
      <p-message severity="error"> 
        No Summary Available!!
      </p-message>
    }
  </p-dialog>

  <!-- Summary options -->
  @if(selectedChapter) {
    <div class="p-col-6">
      <h4>ðŸ§ª Deep Analysis Summaries</h4>
      <div class="summary-radio-row">
        <p-radiobutton name="summary" value="summary1" [(ngModel)]="summaryoption" inputId="summaryoption1" (onClick)="selectSummaryOption(summaryoption)"/>
        <label for="summaryoption1">&nbsp;&nbsp;Summary 1 - Summarize entire chapter using regular ChatGPT</label>
      </div>
      <div class="summary-radio-row">
        <p-radiobutton name="summary" value="summary2" [(ngModel)]="summaryoption" inputId="summaryoption2" (onClick)="selectSummaryOption(summaryoption)"/>
        <label for="summaryoption2">&nbsp;&nbsp;Summary 2 - Summarize the chapter part by part and merge</label>
      </div>
      <div class="summary-radio-row">
        <p-radiobutton name="summary" value="summary3" [(ngModel)]="summaryoption" inputId="summaryoption3" (onClick)="selectSummaryOption(summaryoption)"/>
        <label for="summaryoption3">&nbsp;&nbsp;Summary 3 - Merge Summary 1 and Summary 2 using regular ChatGPT</label>
      </div>
    </div>
  }

  <!-- Generate Summary Button -->
   @if (selectedSummary === "summary1" || selectedSummary === "summary2") {
    <div class="col-12" [align]="'center'" style="margin-top: 20px;">
      <div>
        <p-button [raised]="true"
          label="Generate Summary" 
          icon="pi pi-clipboard" 
          (onClick)="generateSummary()" >
        </p-button>
      </div>
    </div>
  }

  <br><br>  
  @if(generatesummary){
    <!-- @if(selectedSummary === "summary1"){ -->
      @if(summaryvalue === ''){
        <div style="display: flex; justify-content: center; align-items: center;">
          <p-message severity="info">Fetching Summary from ChatGPT...</p-message>
        </div>
        <br>
        <p-progress-spinner ariaLabel="loading" [style]="{ width: '40px', height: '40px' }"/>
      }
      @else {
        <div style="display: flex; justify-content: center; align-items: center;">
          <p-message severity="success">Summary from ChatGPT</p-message>
        </div>
        <br>
        <textarea rows="15" cols="70" pTextarea [(ngModel)]="summaryvalue" readonly></textarea>
        <br><br>
          <p-button [raised]="true"
            label="Save Summary" 
            icon="pi pi-save" 
            (onClick)="saveSummary()" >
          </p-button>
      }
    <!-- } -->
  }
  <br>
</div>
<br><br>
<!-- Professional Footer -->
<footer class="app-footer">
  <div class="footer-content">
    <span>&copy; 2025 SarAIh Maas | Crescent City Series Analysis</span>
    <span class="footer-links">
      <a href="https://github.com/koushick/sarah-maas-AI-chat-UI" target="_blank">GitHub</a>
    </span>
  </div>
</footer>